# 아이템 30. 요소의 가시성을 최소화하라

API를 설계할 때 가능한 한 간결한 API를 선호하는 이유

1. 작은 인터페이스는 배우기 쉽고 유지하기 쉽다.
2. 기능이 많은 클래스보다는 적은 클래스를 이해하는 것이 쉽다.
3. 유지보수가 쉽다.

변경을 가할 때는 기존의 것을 숨기는 것보다 새로운 것을 노출하는 것이 쉽다. 일반적으로 공개적으로 노출되어있는 요소들은 공개API의 일부인데, 이러한 요소들을 변경하면, 이 코드를 사용하는 모둔 부분이 영향을 받는다.

그래서 가시성과 관련된 제한을 변경하는 일은 더욱 어렵다. 

이러한 변경은 신중하게 고려해야 하며, 변경할 경우에는 대체재를 제공해야 한다.

⇒ 처음에는 작은 API로서 개발하도록 강제하는 것이 더 좋다.

세터만 private으로 만드는 이유: 외부에서 코드를 강제로 바꿀 수 없고, 신뢰성 문제가 있어서

→ 일반적으로 코틀린에서는 이처럼 구체 접근자의 가시성을 제한해서 모든 프로퍼티를 캡슐화 하는것이 좋다. 

가시성이 제한될 수록 클래스의 변경을 쉽게 추적할 수 있으며 프로퍼티의 상태를 더 쉽게 이해할 수 있다. 이는 동시성(concurrency)을 처리할 때 중요하다. 상태 변경은 병렬 프로그래밍에서 문제가 된다. 따라서 많은 것을 제한할수록 병렬 프로그래밍을 할 때 안전해진다. 

### 가시성 한정자 사용하기

내부적인 변경 없이 작은 인터페이스를 유지하고 싶다면, 가시성(visibility)을 제한하면 된다. 

기본적으로 클래스와 요소를 외부에 노출할 필요가 없다면, 가시성을 제한해서 외부에서 접근할 수 없게 만드는 것이 좋다. 가시성 제한은 가시성 한정자(visibility modifier)를 활용해서 구현한다.

클래스의 멤버 4가지 가시성

- public(디폴트): 어디에서나 볼 수 있다.
- private: 클래스의 내부에서만 볼 수 있다.
- protected: 클래스와 서브클래스 내부에서만 볼 수 있다.
- internal: 모듈 내부에서만 볼 수 있다.

톱 레벨 요소에는 세 가지 가시성 한정자를 사용할 수 있다.

- public(디폴트): 어디에서나 볼 수 있다.
- private: 같은 파일 내부에서만 볼 수 있다.
- internal: 모듈 내부에서만 볼 수 있다.

모듈과 패키지를 헷갈리지 말 것

코틀린에서의 모듈이란

- gradle 소스 세트
- 메이븐 프로젝트
- 인텔리제이 IDEA 모듈
- 앤트(Ant) 태스크 한 번으로 컴파일 되는 파일 세트

Internal : 만약 모듈이 다른 모듈에 의해서 사용될 가능성이 있는데,  공개하고 싶지 않은 요소를 숨길 때 사용

protected : 요소가 상속을 위해 설계되어 있고, 클래스와 서브클래스에서만 사용되게 만들고 싶을 때 사용

private : 동일한 파일 또는 클래스에서만 요소를 사용하게 만들고 싶을 때 사용

> 참고로 코틀린은 지역적으로만 사용되고 있는 요소는 private으로 만드는 것이 좋다는 컨벤션을 제공한다.
> 

→ 데이터를 저장하도록 설계된 클래스(데이터 모델 클래스, DTO)에는 적용하지 않는 것이 좋다. 데이터를 저장하도록 설계된 클래스는 숨길 이유가 없기때문. 필요하지 않다면 그냥 제거해라~

한가지 큰 제한은, API를 상속할 때 오버라이드해서 가시성을 제한할 수는 없다는 것.

이는 서브클래스가 슈퍼클래스로도 사용될 수 있기 때문이다. 이것이 상속보다는 컴포지션을 사용하는 대표적인 이유이다. 

정리

요소의 가시성은 최대한 제한적인 것이 좋다.

- 인터페이스가 작을수록 이를 공부하고 유지하는 것이 쉽다.
- 최대한 제한이 되어 있어야 변경하기 쉽다.
- 클래스의 상태를 나타내는 프로퍼티가 노출되어 있다면, 클래스가 자신의 상태를 책임질 수 없다.
- 가시성이 제한되면 API의 변경을 쉽게 추적할 수 있다.