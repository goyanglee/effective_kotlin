# 아이템 19. Knowledge를 반복하여 사용하지 말라

“프로젝트에서 이미 있던 코드를 복사해서 붙혀넣고 있다면, 무언가가 잘못된 것이다.” - 필자 생각-

DRY 규칙 -”Don’t Repeat Yourself” - 책: 실용주의 프로그래머"-

WET 안티패턴 - “개발자는 타이핑하는 것을 좋아하므로, 많은 사람의 시간을 낭비하게 만들거나 같은 코드를 두 번씩 작성한다”

SSOT - “Single Source of Truth”

### knowledge : 의도적인 정보

: 프로젝트를 진행 할 때 정의한 모든 것.

: 알고리즘 작동 방식, UI 형태, 우리가 원하는 결과, 코드, 설정, 템플릿 등

: 어떤 도구, 가상머신, 다른 프로그램들에서 직접 또는 간접적으로 이해할 수 있는 정보

가장 중요한 knowledege 두 가지

- 로직 : 프로그램이 어떠한 식으로 동작하는지와 프로그램이 어떻게 보이는지, 계속 변하는 부분
- 공통 알고리즘: 원하는 동작을 하기 위한 알고리즘, 크게 변하지 않는 부분

### 모든 것은 변화한다.

- 회사가 사용자의 요구 또는 습관을 더 많이 알게 되었다.
- 디자인 표준이 변화했다.
- 플랫폼, 라이브러리, 도구 등이 변화해서 이에 대응해야 한다.

많은 관리 시스템은 애자일하며, 요구 사항의 변화를 맞추는 데 적합하다.

모든 것은 변화하고 우리는 이에 대비해야 한다.

변화할 때 가장 큰 적은 knowledege가 반복되어 있는 부분이다

→ 해당 부분을 변경하려면, 우리는 반복된 부분을 모두 찾고, 모두 변경해야 한다. 

→ knowledege 반복은 프로젝트의 확장성(scalable)을 막고, 쉽게 깨지게(fragile) 만든다.

예를들면 SQL을 직접 작성하지 않고 하이버네이트와 같은 ORM,익스포즈드와 같은 DAO를 활용하듯 여러 종류의 추상화를 표현할 수 있는 수많은 솔루션이 있으며, 이를 활용하면 반복을 줄일 수 있다. 

### 언제 코드를 반복해도 될까?

: 얼핏보면 반복처럼 보이지만, 실질적으로 다른 knowledege를 나타내므로 추출하면 안 되는 부분이다.

- 독립적인 2개의 애플리케이션을 만들 때

“함께 변경될 가능성이 높은가? 따로 변경될 가능성이 높은가?” - 질문을 던져봐야한다.

+단일책임원칙을 지켜야 한다.

### 단일 책임 원칙

단일 책임 원칙(Single Responsibility Principle, SRP) : 잘못된 코드 추출로부터 우리를 보호할 수 있는 규칙.

: 코드를 추출해도 되는지를 확인할 수 있는 원칙.

: 클래스를 변경하는 이유는 단 한 가지여야 한다.

: 두 액터(actor)가 같은 클래스를 변경하는 일은 없어야 한다.

액터: 변화를 만들어내는 존재(source of change) : 서로의 업무와 분야에 대해 잘모르는 개발자들로 비유된다.

→ 이러한 개발자들이 같은 코드를 변경하는 것은 굉장히 위험한 일.

예를 들어, 학점을 계산하는 프로퍼티는 같은 기능을 하더라도 장학금 관련부서와 인증관련부서 따로따로 만들어져야한다. 두 부서가 학점을 계산하는 방식이 다르기 때문에, 

어느 한쪽 부서 개발자가 맘대로 학점 계산하는 방식을 변경했다가는 위험하다.

기본적으로 아래와 같이 만드는게 일반적이다.

1. 두 부서에서 모두 사용하는 일반적인 public 함수로 헬퍼 함수를 만듭니다. 공통 부분은 두 부서에서 모두 사용하므로, 이를 함부로 수정해서는 안 되게 규약을 정합니다.
2. 헬퍼 함수를 각각의 부서 모듈에 따라 2개 만듭니다.

두 선택지는 안전하다.

단일 책임 원칙은 우리에게 두가지 사실을 알려준다.

- 서로 다른 곳(위의 예에서는 서로 다른 부서)에서 사용하는 knowledege는 독립적으로 변경할 가능성이 많다. 따라서 비슷한 처리를 하더라도, 완전히 다른 knowledege로 취급하는 것이 좋다.
- 다른 knowledege는 분리해 두는 것이 좋다. 그렇지 않으면, 재사용해서는 안 되는 부분을 재사용하려는 유혹이 발생할 수 있다.

### 정리

모든 것은 변화한다. 따라서 공통 knowledege가 있다면, 이를 추출해서 이러한 변화에 대비해야 한다.

추가적으로 의도하지 않은 수정을 피하려면, 또는 다른 곳(예. 부서)에서 조작하는 부분이 있다면, 분리해서 사용하는 것이 좋다. 극단적이지 말고 균형을 맞춰라.